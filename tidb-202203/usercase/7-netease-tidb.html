<!DOCTYPE HTML>
<html lang="zh-CN" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>网易这么牛的迁移方案你学会了吗？ - TiDB 社区技术月刊</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../../index.html">TiDB 社区技术月刊</a></li><li class="chapter-item expanded "><a href="../../tidb-202202/202202-prefix.html"><strong aria-hidden="true">1.</strong> 2022 年 2 月刊</a></li><li class="chapter-item expanded "><a href="../../tidb-202203/202203-prefix.html"><strong aria-hidden="true">2.</strong> 2022 年 3 月刊</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../tidb-202203/product-news/update.html"><strong aria-hidden="true">2.1.</strong> 产品更新</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../tidb-202203/product-news/tidb-6.0.html"><strong aria-hidden="true">2.1.1.</strong> TiDB 6.0 发版：向企业级云数据库迈进</a></li><li class="chapter-item expanded "><a href="../../tidb-202203/product-news/tiflash.html"><strong aria-hidden="true">2.1.2.</strong> TiFlash 开源了</a></li><li class="chapter-item expanded "><a href="../../tidb-202203/product-news/tiflash-resource.html"><strong aria-hidden="true">2.1.3.</strong> TiFlash 快速上手资源汇总</a></li></ol></li><li class="chapter-item expanded "><a href="../../tidb-202203/product-news/bug.html"><strong aria-hidden="true">2.2.</strong> 产品 Bug 及兼容性问题</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../tidb-202203/product-news/tiflash-crash.html"><strong aria-hidden="true">2.2.1.</strong> TiFlash 在开启了 TLS 的情况下会随机 crash</a></li><li class="chapter-item expanded "><a href="../../tidb-202203/product-news/tiflash-v5_4_0.html"><strong aria-hidden="true">2.2.2.</strong> TiFlash 从低版本升级到 v5.4.0 后，元数据丢失，无法响应查询请求</a></li><li class="chapter-item expanded "><a href="../../tidb-202203/product-news/tikv-nodes.html"><strong aria-hidden="true">2.2.3.</strong> 由于 Placement Rule 设置不合理导致 TiKV 节点不均衡</a></li></ol></li><li class="chapter-item expanded "><a href="../../tidb-202203/product-news/development.html"><strong aria-hidden="true">2.3.</strong> 开发适配</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../tidb-202203/product-news/ent-tidb.html"><strong aria-hidden="true">2.3.1.</strong> Facebook 开源 Golang 实体框架 Ent 现已支持 TiDB</a></li><li class="chapter-item expanded "><a href="../../tidb-202203/product-news/flink-tidb.html"><strong aria-hidden="true">2.3.2.</strong> Flink CDC 2.2 正式发布，新增 TiDB 数据源，新增 TiDB CDC 连接器</a></li></ol></li><li class="chapter-item expanded "><a href="../../tidb-202203/usercase/usercase.html"><strong aria-hidden="true">2.4.</strong> 用户实践</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../tidb-202203/usercase/1-infra-value.html"><strong aria-hidden="true">2.4.1.</strong> 黄东旭： 关于基础软件产品价值的思考</a></li><li class="chapter-item expanded "><a href="../../tidb-202203/usercase/2-inspur-tidb.html"><strong aria-hidden="true">2.4.2.</strong> 国产化浪潮下 TiDB 解决的痛点问题</a></li><li class="chapter-item expanded "><a href="../../tidb-202203/usercase/3-tidb-cluster.html"><strong aria-hidden="true">2.4.3.</strong> TiDB集群恢复之TiKV集群不可用</a></li><li class="chapter-item expanded "><a href="../../tidb-202203/usercase/4-PointGet.html"><strong aria-hidden="true">2.4.4.</strong> PointGet 的一生</a></li><li class="chapter-item expanded "><a href="../../tidb-202203/usercase/5-TiDB-code.html"><strong aria-hidden="true">2.4.5.</strong> TiDB 源码系列之沉浸式编译 TiDB</a></li><li class="chapter-item expanded "><a href="../../tidb-202203/usercase/6-ctrip-tidb.html"><strong aria-hidden="true">2.4.6.</strong> 分布式数据库TiDB在携程的实践</a></li><li class="chapter-item expanded "><a href="../../tidb-202203/usercase/7-netease-tidb.html" class="active"><strong aria-hidden="true">2.4.7.</strong> 网易这么牛的迁移方案你学会了吗？</a></li><li class="chapter-item expanded "><a href="../../tidb-202203/usercase/8-tidb-server-oom.html"><strong aria-hidden="true">2.4.8.</strong> TiDB Server 的 OOM 问题优化探索</a></li><li class="chapter-item expanded "><a href="../../tidb-202203/usercase/9-ccbfintech-chaos.html"><strong aria-hidden="true">2.4.9.</strong> 混沌工程在建信金科的应用实践</a></li><li class="chapter-item expanded "><a href="../../tidb-202203/usercase/10-tuning-hardware.html"><strong aria-hidden="true">2.4.10.</strong> 数据库调优之硬件</a></li><li class="chapter-item expanded "><a href="../../tidb-202203/usercase/11-TiDB-HATP.html"><strong aria-hidden="true">2.4.11.</strong> TiDB的HATP对我们来说意味着什么？</a></li><li class="chapter-item expanded "><a href="../../tidb-202203/usercase/12-TiEM-test.html"><strong aria-hidden="true">2.4.12.</strong> TiEM 初体验</a></li></ol></li><li class="chapter-item expanded "><a href="../../tidb-202203/community-news/community-news.html"><strong aria-hidden="true">2.5.</strong> 社区动态</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../tidb-202203/community-news/event-summary.html"><strong aria-hidden="true">2.5.1.</strong> 近期活动预告</a></li><li class="chapter-item expanded "><a href="../../tidb-202203/community-news/upcoming-event.html"><strong aria-hidden="true">2.5.2.</strong> 本月精彩活动回顾</a></li><li class="chapter-item expanded "><a href="../../tidb-202203/community-news/MVA-202203.html"><strong aria-hidden="true">2.5.3.</strong> 3 月社区 MVA（Most Valuable Advocate）</a></li><li class="chapter-item expanded "><a href="../../tidb-202203/community-news/contributors.html"><strong aria-hidden="true">2.5.4.</strong> Contributor 动态</a></li></ol></li><li class="chapter-item expanded "><a href="../../tidb-202203/tidb-certification/tidb-certification.html"><strong aria-hidden="true">2.6.</strong> TiDB 能力认证</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../tidb-202203/tidb-certification/pcta-pctp.html"><strong aria-hidden="true">2.6.1.</strong> 认证介绍 &amp; 考试安排</a></li><li class="chapter-item expanded "><a href="../../tidb-202203/tidb-certification/tidb-course.html"><strong aria-hidden="true">2.6.2.</strong> TiDB 课程推荐</a></li></ol></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">TiDB 社区技术月刊</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/luzizhuo/TiDB-Monthly-202203" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="网易这么牛的迁移方案你学会了吗ddb迁移tidb方案设计"><a class="header" href="#网易这么牛的迁移方案你学会了吗ddb迁移tidb方案设计">网易这么牛的迁移方案你学会了吗？【DDB迁移TiDB方案设计】</a></h1>
<p>转载来自：https://mp.weixin.qq.com/s/8JcrLSJQkT2_VKr3i4pgYg</p>
<p><strong>作者：张振祥</strong></p>
<p><strong>公众号：不错技术所</strong></p>
<p>目前公司已经多个业务上线TIDB服务,包括网易支付对账中心,网易云音乐心遇榜单系统等,但这些均是新业务直接上线TIDB。为探索<strong>已有业务迁移TIDB</strong>,本文对一些<strong>迁移方案</strong>进行了总结。</p>
<p><strong>一、TiDB简介</strong></p>
<p><img src="https://tidb-blog.oss-cn-beijing.aliyuncs.com/media/2dc5eeacc22e8ae72fdf4ac581457769-1647941326712.png" alt="2dc5eeacc22e8ae72fdf4ac581457769.png" /></p>
<ul>
<li>
<p><strong>TiDB Server</strong>：SQL 层，对外暴露 MySQL 协议的连接 endpoint，负责接受客户端的连接，执行 SQL 解析和优化，最终<strong>生成分布式执行计划</strong>。<strong>TiDB 层本身是无状态的</strong>，实践中可以启动多个 TiDB 实例，通过负载均衡组件（如 LVS、HAProxy 或 F5）对外提供统一的接入地址，<strong>客户端的连接可以均匀地分摊在多个 TiDB 实例上以达到负载均衡的效果</strong>。<strong>TiDB Server 本身并不存储数据</strong>，只是解析 SQL，将实际的数据读取请求转发给底层的存储节点 TiKV（或 TiFlash）</p>
</li>
<li>
<p><strong>PD (Placement Driver) Server</strong>：<strong>整个 TiDB 集群的元信息管理模块</strong>，负责存储每个 TiKV 节点实时的数据分布情况和集群的整体拓扑结构，提供 TiDB Dashboard 管控界面，并为分布式事务分配事务 ID。PD 不仅<strong>存储元信息</strong>，同时还会<strong>根据 TiKV 节点实时上报的数据分布状态，下发数据调度命令给具体的 TiKV 节点</strong>，可以说是整个集群的“大脑”。此外，PD 本身也是由至少 3 个节点构成，拥有<strong>高可用</strong>的能力。<strong>建议部署奇数个 PD 节点</strong></p>
</li>
</ul>
<p><strong>存储节点</strong></p>
<ol>
<li><strong>TiKV Server</strong>：负责存储数据，<strong>从外部看 TiKV 是一个分布式的提供事务的 Key-Value 存储引擎</strong>。存储数据的基本单位是 Region，每个 Region 负责存储一个 Key Range（从 StartKey 到 EndKey 的左闭右开区间）的数据，每个 TiKV 节点会负责多个 Region。</li>
<li>TiKV 的 API 在 KV 键值对层面提供对分布式事务的原生支持，<strong>默认提供</strong>了 SI (Snapshot Isolation) 的隔离级别，这也是 <strong>TiDB 在 SQL 层面支持分布式事务的核心</strong>。TiDB 的 SQL 层做完 SQL 解析后，会将 SQL 的执行计划转换为对 TiKV API 的实际调用。所以，<strong>数据都存储在 TiKV 中</strong>。另外，TiKV 中的数据都会自动维护多副本（默认为三副本），<strong>天然支持高可用和自动故障转移</strong>。</li>
<li><strong>TiFlash</strong>：TiFlash 是一类特殊的存储节点。和普通 TiKV 节点不一样的是，<strong>在 TiFlash 内部，数据是以列式的形式进行存储，主要的功能是为分析型的场景加速</strong></li>
</ol>
<p><strong>TIDB 优势</strong></p>
<p><strong>1.提供DDB同等程度的水平扩容能力</strong></p>
<p><strong>2.SQL支持能力较DDB好, 性能相当,DDB SQL 会有很多限制</strong></p>
<p>比如说查询时要求要带上均衡字段、不建议做表join 操作等等;均衡字段不可频繁update, update 需要用 delete+insert;唯一约束限制,所有唯一键均需要加上均很字段,否则无法保证唯一</p>
<p><strong>3.资源扩缩容粒度更加灵活, 不需要像DDB, 每次都翻倍扩容</strong></p>
<p><strong>4.数据一致性下限提升</strong></p>
<p><strong>5.数据存储成本一定程度降低</strong></p>
<p>P_ABTEST_TEST_AGG 表1.5亿行,MySQL占用空间337G  TiDB 84G ,当然这是比较极端的情况,<strong>一般来讲我们认为TIDB磁盘存储 较DDB 会有下降30%</strong>。不需要raid10+rocksdb压缩-rockdb写放大</p>
<p><strong>6.主从复制效率显著提高, 降低写负载下一致性和高可用降级的风险</strong></p>
<p><strong>7.扩容行为效率和安全性</strong></p>
<p><strong>8.在线DDL支持更好, 除了加索引基本都是秒回, 大表增加修改列成本显著降低</strong></p>
<p><strong>9.高可用自动恢复可靠性与效率显著提升</strong></p>
<p><strong>10.HTAP能力能够减少数据传输环节的成本和风险, 提供业务更高效的实时分析能力</strong></p>
<p>某些场景下聚合查询的效率是MySQL的100倍</p>
<p>https://pingcap.com/blog-cn/tidb-and-tiflash-vs-mysql-mariadb-greenplum-apache-spark/</p>
<p><strong>二、DDB(QS模式) 迁移TIDB 方案设计</strong></p>
<p><strong>梳理应用以及表的对应关系</strong></p>
<p><strong>确认迁移的业务域</strong> </p>
<p>实际上一般我们以<strong>表维度</strong>来划分，如果<strong>有表级别的耦合</strong>我们会要求<strong>先进行业务改造</strong></p>
<p><img src="https://tidb-blog.oss-cn-beijing.aliyuncs.com/media/21fbf69159762cabb1b1622e2d681455-1647941394329.png" alt="21fbf69159762cabb1b1622e2d681455.png" /></p>
<p><strong>业务兼容性改造</strong></p>
<p>不支持 FLOAT4/FLOAT8类型</p>
<p>不支持 XA语法（TiDB 内部使用两阶段提交，但并没有通过 SQL 接口公开）</p>
<p>不支持 savepoints</p>
<p>不支持 存储过程/触发器</p>
<p>不支持 SELECT ... INTO @变量 语法</p>
<p>不支持 SELECT ... GROUP BY ... WITH ROLLUP 语法</p>
<p>不支持 外键约束</p>
<p>不支持 视图修改,业务需要梳理是否有相关依赖</p>
<p>因explicit_defaults_for_timestamp默认值不一致,需要梳理有没有insert timestamp字段为null的逻辑（TiDB 默认：ON，且仅支持设置该值为 ON。MySQL 5.7 默认：OFF。MySQL 8.0 默认：ON）</p>
<p>自增ID,自增列仅保证唯一,不保证自增。业务需要梳理是否有依赖自增特性的逻辑（TiDB 的自增列仅保证唯一，也能保证在单个 TiDB server 中自增，但不保证多个 TiDB server 中自增）</p>
<p>指定默认字符集/字符序为utf8mb4_bin、utf8mb4_general_ci</p>
<p>不支持修改 decimal 类型的精度</p>
<p>不支持有损变更，以及部分数据类型的更改（包括整数改为字符串或 BLOB 格式等）</p>
<p><strong>连接串修改</strong></p>
<p>jdbc.dirver=com.mysql.jdbc.Driver jdbc.url=jdbc:mysql://10.170.208.12:6006/tidb_database</p>
<p><strong>数据同步以及一致性校验</strong></p>
<p><img src="https://tidb-blog.oss-cn-beijing.aliyuncs.com/media/d5377cf5748b958ec9c9aadf0338445c-1647941433748.png" alt="d5377cf5748b958ec9c9aadf0338445c.png" /></p>
<p><strong>数据源切换方案</strong></p>
<p><strong>非LBD模式的QS</strong></p>
<ul>
<li><strong>业务切换</strong></li>
</ul>
<ol>
<li>业务改造成<strong>域名访问</strong>的方式</li>
<li><strong>低峰期通过切换域名的方式</strong>切换数据源</li>
<li><strong>源端rename表</strong>(为了避免出现双写,确定没有其他业务连该表)</li>
<li>域名切换</li>
<li>Kill  老库连接</li>
</ol>
<ul>
<li><strong>数据回滚</strong></li>
</ul>
<p>通过<strong>设置反向同步任务</strong>回滚数据</p>
<p><strong>优点</strong>：业务除开连接串的修改外无需做任何修改</p>
<p><strong>LBD/DBI模式</strong></p>
<ul>
<li><strong>灰度发布</strong></li>
</ul>
<p>业务仅做兼容性改造</p>
<p><strong>切换方案</strong>：遵循灰度发布程序</p>
<p><strong>回滚方案</strong>：1.下掉灰度机器;2.新写入的数据做回滚 </p>
<p><strong>优点</strong>：业务改造比较少</p>
<p><strong>缺点</strong>：可能会出现双写的情况,数据可能会冲突</p>
<ul>
<li><strong>业务热开关切换</strong></li>
</ul>
<p>业务需要做兼容性及数据源热切开关改造</p>
<p><strong>切换方案</strong>：1. 源表rename，确保没有其他业务使用；2. 业务开启禁写开关；3. 业务流量切换；4. 业务开启读写,完成切换</p>
<p><strong>回滚方案</strong>：回滚方案需要考虑到<strong>新增数据反向同步</strong></p>
<p><strong>优点</strong>：业务改造比较少，无需加入异步写逻辑，也无需关心数据不一致情况，且能保证数据一致性,</p>
<p><strong>缺点</strong>：切换一刀切，未经灰度验证</p>
<ul>
<li><strong>业务双写方案</strong></li>
</ul>
<p>业务通过热开关可以切换成 读写DDB，读写DDB+异步写TiDB ，读写TiDB + 异步写DDB，仅读写TiDB</p>
<p><strong>读写DDB+异步写TiDB 时的切换方案</strong>：1.DDB中设置read_only；2. 等等NDC 增量同步完成；3. DBA关闭同步任务；4. 业务开启异步写TiDB；5. DDB中开启读写</p>
<p><strong>回滚</strong>：业务直接切换到<strong>仅读写DDB</strong> 就行</p>
<p><strong>优点</strong>：经过较长时间的灰度,<strong>稳定性/安全性较高</strong></p>
<p>如果异常回滚较为迅速无损</p>
<p><strong>问题</strong>：业务改造较多,<strong>需要加入异步写逻辑,热切开关等逻辑</strong>；另外还需要考虑<strong>异步写的数据一致性</strong>问题</p>
<p><strong>三、数据同步上下游工具</strong></p>
<p>数据同步以及回滚数据链路图</p>
<p><img src="https://tidb-blog.oss-cn-beijing.aliyuncs.com/media/b6f3e22a837c17729697f3189e8164e7-1647941475926.png" alt="b6f3e22a837c17729697f3189e8164e7.png" /></p>
<p>TIDB数据接入NDC数据链路图</p>
<p><img src="https://tidb-blog.oss-cn-beijing.aliyuncs.com/media/c700d1237e6ef74cac4aaee19790a542-1647941492244.png" alt="c700d1237e6ef74cac4aaee19790a542.png" /></p>
<p><strong>TiCDC 监控</strong>详解见：</p>
<p>https://docs.pingcap.com/zh/tidb/v4.0/monitor-ticdc</p>
<p><strong>●Changefeed table count</strong>：一个同步任务中分配到各个 TiCDC 节点同步的数据表个数</p>
<p><strong>●Processor resolved ts</strong>：TiCDC 节点内部状态中已同步的时间点</p>
<p>Table resolved ts：同步任务中各数据表的同步进度</p>
<p><strong>●Changefeed checkpoint</strong>：同步任务同步到下游的进度，正常情况下绿柱应和黄线相接</p>
<p><strong>● PD etcd requests/s</strong>：TiCDC 节点每秒向 PD 读写数据的次数</p>
<p><strong>● Exit error count</strong>：每分钟内导致同步中断的错误发生次数</p>
<p>TICDC 报警规则</p>
<p><img src="https://tidb-blog.oss-cn-beijing.aliyuncs.com/media/4cf56cf402517d3dd9ce04107330da74-1647941509808.png" alt="4cf56cf402517d3dd9ce04107330da74.png" /></p>
<p>TIDB 监控报警框架</p>
<p><img src="https://tidb-blog.oss-cn-beijing.aliyuncs.com/media/d1b4124c7be541fa23f86185bd1f9119-1647941521010.png" alt="1.png" /></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../tidb-202203/usercase/6-ctrip-tidb.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../../tidb-202203/usercase/8-tidb-server-oom.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../tidb-202203/usercase/6-ctrip-tidb.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../../tidb-202203/usercase/8-tidb-server-oom.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
